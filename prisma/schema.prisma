generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model brand {
  brandId           Int        @id @default(autoincrement())
  brandName         String?    @unique
  description       String?
  country           String?
  isActive          Boolean?   @default(true)
  createdAt         DateTime?  @default(now())
  createdBy         Int
  updatedAt         DateTime?  @default(now())
  updatedBy         Int
  deletedAt         DateTime?
  deletedBy         Int?
  createdByEmployee employees  @relation("brand_createdBy", fields: [createdBy], references: [EmployeeID])
  deletedByEmployee employees? @relation("brand_deletedBy", fields: [deletedBy], references: [EmployeeID])
  updatedByEmployee employees  @relation("brand_updatedBy", fields: [updatedBy], references: [EmployeeID])
  model             model[]
  product           product[]

  @@map("brand")
}

model category {
  categoryId        Int        @id @default(autoincrement())
  categoryName      String?
  description       String?
  isActive          Boolean?   @default(true)
  createdAt         DateTime?  @default(now())
  createdBy         Int
  updatedAt         DateTime?  @default(now())
  updatedBy         Int
  deletedAt         DateTime?
  deletedBy         Int?
  mainCategory      String?
  createdByEmployee employees  @relation("category_createdBy", fields: [createdBy], references: [EmployeeID])
  deletedByEmployee employees? @relation("category_deletedBy", fields: [deletedBy], references: [EmployeeID])
  updatedByEmployee employees  @relation("category_updatedBy", fields: [updatedBy], references: [EmployeeID])
  product           product[]

  @@map("category")
}

model employees {
  EmployeeID               Int              @id @default(autoincrement())
  Email                    String           @unique
  Phone                    String?
  UserName                 String           @unique
  Password                 String
  RoleID                   Int
  CreatedBy                Int?
  CreatedDate              DateTime?        @default(now())
  bincard                  bincard[]
  brand_createdBy          brand[]          @relation("brand_createdBy")
  brand_deletedBy          brand[]          @relation("brand_deletedBy")
  brand_updatedBy          brand[]          @relation("brand_updatedBy")
  category_createdBy       category[]       @relation("category_createdBy")
  category_deletedBy       category[]       @relation("category_deletedBy")
  category_updatedBy       category[]       @relation("category_updatedBy")
  gin                      gin[]
  grn                      grn[]
  importfile               importfile[]
  model_createdBy          model[]          @relation("model_createdBy")
  model_deletedBy          model[]          @relation("model_deletedBy")
  model_updatedBy          model[]          @relation("model_updatedBy")
  product_createdBy        product[]        @relation("product_createdBy")
  product_deletedBy        product[]        @relation("product_deletedBy")
  product_updatedBy        product[]        @relation("product_updatedBy")
  productversion_createdBy productversion[] @relation("productVersion_createdBy")
  productversion_deletedBy productversion[] @relation("productVersion_deletedBy")
  productversion_updatedBy productversion[] @relation("productVersion_updatedBy")
  returns                  returns[]
  supplier_createdBy       supplier[]       @relation("supplier_createdBy")
  supplier_deletedBy       supplier[]       @relation("supplier_deletedBy")
  supplier_updatedBy       supplier[]       @relation("supplier_updatedBy")
  transactionlog           transactionlog[]

  @@map("employees")
}

model model {
  modelId           Int        @id @default(autoincrement())
  modelName         String?
  description       String?
  brandId           Int
  isActive          Boolean?   @default(true)
  createdAt         DateTime?  @default(now())
  createdBy         Int
  updatedAt         DateTime?  @default(now())
  updatedBy         Int
  deletedAt         DateTime?
  deletedBy         Int?
  brand             brand      @relation(fields: [brandId], references: [brandId])
  createdByEmployee employees  @relation("model_createdBy", fields: [createdBy], references: [EmployeeID])
  deletedByEmployee employees? @relation("model_deletedBy", fields: [deletedBy], references: [EmployeeID])
  updatedByEmployee employees  @relation("model_updatedBy", fields: [updatedBy], references: [EmployeeID])
  product           product[]

  @@map("model")
}

model product {
  productId         Int               @id @default(autoincrement())
  sku               String?           @unique
  productName       String?
  description       String?
  categoryId        Int
  brandId           Int
  modelId           Int
  createdBy         Int
  supplierId        Int
  isActive          Boolean?          @default(true)
  createdAt         DateTime?         @default(now())
  updatedAt         DateTime?         @updatedAt
  updatedBy         Int?
  deletedBy         Int?
  deletedAt         DateTime?
  gindetails        gindetails[]
  grndetails        grndetails[]
  brand             brand             @relation(fields: [brandId], references: [brandId])
  category          category          @relation(fields: [categoryId], references: [categoryId])
  createdByEmployee employees         @relation("product_createdBy", fields: [createdBy], references: [EmployeeID])
  deletedByEmployee employees?        @relation("product_deletedBy", fields: [deletedBy], references: [EmployeeID])
  model             model             @relation(fields: [modelId], references: [modelId])
  supplier          supplier          @relation(fields: [supplierId], references: [supplierId])
  updatedByEmployee employees?        @relation("product_updatedBy", fields: [updatedBy], references: [EmployeeID])
  productSupplier   productsupplier[]
  productVersion    productversion[]
  stock             stock[]

  @@index([productId, deletedAt], map: "idx_product_id_deleted")
  @@map("product")
}

model productsupplier {
  productSupplierId Int       @id
  productId         Int
  supplierId        Int
  startDate         DateTime?
  endDate           DateTime?
  isPrimarySupplier Boolean?
  status            String?
  createdBy         Int?
  createdAt         DateTime?
  updatedBy         Int?
  updatedAt         DateTime?
  deletedBy         Int?
  deletedAt         DateTime?
  product           product   @relation(fields: [productId], references: [productId])
  supplier          supplier  @relation(fields: [supplierId], references: [supplierId])

  @@map("productsupplier")
}

model productvariation {
  variationId   Int             @id @default(autoincrement())
  versionId     Int
  variationName String?
  color         String?
  size          String?
  capacity      String?
  barcode       String?
  price         Decimal?
  quantity      Int?
  minStockLevel Int?
  maxStockLevel Int?
  isActive      Boolean?        @default(true)
  createdBy     Int?
  createdAt     DateTime?       @default(now())
  updatedBy     Int?
  updatedAt     DateTime?       @updatedAt
  deletedBy     Int?
  deletedAt     DateTime?
  bincard       bincard[]
  version       productversion  @relation(fields: [versionId], references: [versionId])
  returnproduct returnproduct[]
  specdetails   specdetails[]
  stock         stock[]

  @@map("productvariation")
}

model productversion {
  versionId         Int                @id @default(autoincrement())
  productId         Int
  versionNumber     String?
  releaseDate       DateTime?
  isActive          Boolean?           @default(true)
  createdBy         Int?
  createdAt         DateTime?          @default(now())
  updatedBy         Int?
  updatedAt         DateTime?          @updatedAt
  deletedBy         Int?
  deletedAt         DateTime?
  variations        productvariation[]
  createdByEmployee employees?         @relation("productVersion_createdBy", fields: [createdBy], references: [EmployeeID])
  deletedByEmployee employees?         @relation("productVersion_deletedBy", fields: [deletedBy], references: [EmployeeID])
  product           product            @relation(fields: [productId], references: [productId])
  updatedByEmployee employees?         @relation("productVersion_updatedBy", fields: [updatedBy], references: [EmployeeID])

  @@map("productversion")
}

model roles {
  RoleID      Int     @id @default(autoincrement())
  RoleName    String
  Description String?

  @@map("roles")
}

model specs {
  specId      Int           @id @default(autoincrement())
  specName    String?
  createdBy   Int?
  createdAt   DateTime?
  updatedBy   Int?
  updatedAt   DateTime?
  deletedBy   Int?
  deletedAt   DateTime?
  specdetails specdetails[]

  @@map("specs")
}

model specdetails {
  specDetailId Int              @id @default(autoincrement())
  variationId  Int
  specId       Int
  specValue    String?
  createdBy    Int?
  createdAt    DateTime?        @default(now())
  updatedBy    Int?
  updatedAt    DateTime?        @updatedAt
  deletedBy    Int?
  deletedAt    DateTime?
  spec         specs            @relation(fields: [specId], references: [specId])
  variation    productvariation @relation(fields: [variationId], references: [variationId])

  @@map("specdetails")
}

model supplier {
  supplierId        Int               @id @default(autoincrement())
  supplierName      String?
  contactPerson     String?
  email             String?
  phone             String?
  address           String?
  city              String?
  country           String?
  isActive          Boolean?          @default(true)
  createdAt         DateTime?         @default(now())
  createdBy         Int
  updatedAt         DateTime?         @default(now())
  updatedBy         Int
  deletedAt         DateTime?
  deletedBy         Int?
  grn               grn[]
  product           product[]
  productsupplier   productsupplier[]
  returns           returns[]
  createdByEmployee employees         @relation("supplier_createdBy", fields: [createdBy], references: [EmployeeID])
  deletedByEmployee employees?        @relation("supplier_deletedBy", fields: [deletedBy], references: [EmployeeID])
  updatedByEmployee employees         @relation("supplier_updatedBy", fields: [updatedBy], references: [EmployeeID])

  @@index([supplierId, deletedAt], map: "idx_supplier_id_deleted")
  @@map("supplier")
}

model bincard {
  bincardId        Int              @id @default(autoincrement())
  variationId      Int
  transactionDate  DateTime?        @db.Date
  transactionType  String?          @db.VarChar
  referenceId      Int?
  quantityIn       Int?
  quantityOut      Int?
  balance          Int?
  employeeId       Int
  remarks          String?
  employees        employees        @relation(fields: [employeeId], references: [EmployeeID], onDelete: NoAction, onUpdate: NoAction, map: "fk_bincard_employee")
  productvariation productvariation @relation(fields: [variationId], references: [variationId], onDelete: NoAction, onUpdate: NoAction, map: "fk_bincard_variation")
}

model gin {
  ginId       Int          @id @default(autoincrement())
  ginNumber   String?      @unique @db.VarChar
  employeeId  Int
  issuedTo    String?      @db.VarChar
  issueReason String?      @db.VarChar
  issueDate   DateTime?    @db.Date
  remarks     String?
  createdDate DateTime?    @db.Timestamp(6)
  updatedDate DateTime?    @db.Timestamp(6)
  stockId     Int?
  employees   employees    @relation(fields: [employeeId], references: [EmployeeID], onDelete: NoAction, onUpdate: NoAction, map: "fk_gin_employee")
  stock       stock?       @relation(fields: [stockId], references: [stockId], onDelete: NoAction, onUpdate: NoAction, map: "fk_gin_stock")
  gindetails  gindetails[]
}

model gindetails {
  ginDetailId    Int      @id @default(autoincrement())
  ginId          Int
  productId      Int
  quantityIssued Int?
  unitCost       Decimal? @db.Decimal
  subTotal       Decimal? @db.Decimal
  location       String?
  gin            gin      @relation(fields: [ginId], references: [ginId], onDelete: NoAction, onUpdate: NoAction, map: "fk_gindetails_gin")
  product        product  @relation(fields: [productId], references: [productId], onDelete: NoAction, onUpdate: NoAction, map: "fk_gindetails_product")
}

model grn {
  grnId        Int          @id @default(autoincrement())
  grnNumber    String?      @unique @db.VarChar
  supplierId   Int
  employeeId   Int
  receivedDate DateTime?    @db.Date
  totalAmount  Decimal?     @db.Decimal
  remarks      String?
  createdDate  DateTime?    @db.Timestamp(6)
  updatedDate  DateTime?    @db.Timestamp(6)
  stockId      Int?
  employees    employees    @relation(fields: [employeeId], references: [EmployeeID], onDelete: NoAction, onUpdate: NoAction, map: "fk_grn_employee")
  stock        stock?       @relation(fields: [stockId], references: [stockId], onDelete: NoAction, onUpdate: NoAction, map: "fk_grn_stock")
  supplier     supplier     @relation(fields: [supplierId], references: [supplierId], onDelete: NoAction, onUpdate: NoAction, map: "fk_grn_supplier")
  grndetails   grndetails[]
}

model grndetails {
  grnDetailId      Int      @id @default(autoincrement())
  grnId            Int
  productId        Int
  quantityReceived Int?
  unitCost         Decimal? @db.Decimal
  subTotal         Decimal? @db.Decimal
  location         String?
  grn              grn      @relation(fields: [grnId], references: [grnId], onDelete: NoAction, onUpdate: NoAction, map: "fk_grndetails_grn")
  product          product  @relation(fields: [productId], references: [productId], onDelete: NoAction, onUpdate: NoAction, map: "fk_grndetails_product")
}

model stock {
  stockId           Int               @id @default(autoincrement())
  productId         Int
  quantityAvailable Int?
  reorderLevel      Int?
  lastUpdatedDate   DateTime?         @db.Timestamp(6)
  variationId       Int?
  location          String?           @db.VarChar
  gin               gin[]
  grn               grn[]
  product           product           @relation(fields: [productId], references: [productId], onDelete: NoAction, onUpdate: NoAction, map: "fk_stock_product")
  productvariation  productvariation? @relation(fields: [variationId], references: [variationId], onDelete: NoAction, onUpdate: NoAction, map: "fk_stock_variation")

  @@index([productId, variationId], map: "idx_stock_product_variation")
}

model transactionlog {
  logId       Int       @id @default(autoincrement())
  employeeId  Int
  actionType  String?   @db.VarChar
  entityName  String?   @db.VarChar
  referenceId Int?
  actionDate  DateTime? @db.Timestamp(6)
  oldValue    String?
  newValue    String?
  employees   employees @relation(fields: [employeeId], references: [EmployeeID], onDelete: NoAction, onUpdate: NoAction, map: "fk_transactionlog_employee")
}

model returns {
  returnId      Int             @id @default(autoincrement())
  supplierId    Int
  employeeId    Int
  returnType    String?         @db.VarChar
  returnDate    DateTime?       @db.Date
  reason        String?
  remarks       String?
  approved      Boolean?
  returnStatus  String?         @db.VarChar
  returnproduct returnproduct[]
  employees     employees       @relation(fields: [employeeId], references: [EmployeeID], onDelete: NoAction, onUpdate: NoAction, map: "fk_return_employee")
  supplier      supplier        @relation(fields: [supplierId], references: [supplierId], onDelete: NoAction, onUpdate: NoAction, map: "fk_return_supplier")
}

model returnproduct {
  returnProductId  Int              @id @default(autoincrement())
  returnId         Int
  variationId      Int
  quantity         Int?
  remarks          String?
  returns          returns          @relation(fields: [returnId], references: [returnId], onDelete: NoAction, onUpdate: NoAction, map: "fk_returnproduct_return")
  productvariation productvariation @relation(fields: [variationId], references: [variationId], onDelete: NoAction, onUpdate: NoAction, map: "fk_returnproduct_variation")
}

model importfile {
  importId   Int       @id @default(autoincrement())
  EmployeeID Int
  fileName   String?   @db.VarChar(255)
  fileType   String?   @db.VarChar(50)
  importDate DateTime? @default(now()) @db.Timestamp(6)
  status     String?   @db.VarChar(50)
  errorCount Int?      @default(0)
  remarks    String?
  filePath   String?   @db.VarChar(500)
  employees  employees @relation(fields: [EmployeeID], references: [EmployeeID], map: "fk_importfile_employee")
}
